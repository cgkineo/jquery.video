(function($){function t(t,s){i(this,t),this.t(s)}$("<style>",{text:"[for][kind=buffering]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=buffering]{display:none;}[for][kind=buffering].buffering{display:block;}[for][kind=captions]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=captions] .cue{position:absolute;font-size:100%;line-height:120%;}[for][kind=captions] .cue .cue-text{background-color:black;color:white;padding:0.2%;}[for][kind=captions] .cue.horizontal{transform:translateX(-50%);}[for][kind=captions] .cue.lr{transform:translateY(-50%);}[for][kind=captions] .cue.rl{transform:translateY(-50%);}[for][kind=captions] .cue.align-left{text-align:left;}[for][kind=captions] .cue.align-right{text-align:right;}[for][kind=captions] .cue.align-center{text-align:center;}[for][kind=captions] .cue.align-top{text-align:left;}[for][kind=captions] .cue.align-middle{text-align:right;}[for][kind=captions] .cue.align-bottom{text-align:center;}[for][kind=controls]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=controls]{opacity:1;transition:opacity 0.2s ease-in;}[for][kind=controls].playing .big-play{opacity:0;}[for][kind=poster]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=poster] img{opacity:1;transition:opacity 0.2s ease-in;}[for][kind=poster].paused.in-middle img,[for][kind=poster].playing img{opacity:0;}[for][kind=controls] .scrub{position:absolute;bottom:0;width:100%;background:rgba(255, 255, 255, 0.82);}[for][kind=controls] .scrub .rail{margin:8px;position:relative;}[for][kind=controls] .scrub .rail .rail-back{position:absolute;top:0;left:0;right:0;bottom:0;background-color:lightgrey;}[for][kind=controls] .scrub .rail .rail-inner{position:relative;height:8px;background-color:#d45971;transition:width 0.1s linear;}[for][kind=controls] .scrub{opacity:1;transition:opacity 0.2s ease-in;}[for][kind=controls].paused.at-start .scrub,[for][kind=controls].paused.at-end .scrub,[for][kind=controls].playing .scrub{opacity:0}[for][kind=controls].mousemove.paused.in-middle .scrub,[for][kind=controls].mousemove.paused.at-end .scrub,[for][kind=controls].mousemove.playing .scrub{opacity:1}"}).appendTo("head");var i=$.extend,s="prototype";$.indexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(s):t,e=n.match(i);return e?n.indexOf(e[0])+s:-1},$.lastIndexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(0,s):t,e=n.match(i);return e?n.lastIndexOf(e[e.length-1]):-1},$.chain=function(t,i){return function(){var n=Array[s].slice.call(arguments,0);return n.unshift(function(){var i=Array[s].slice.call(arguments,0);return t.apply(this,i)}.bind(this)),i.apply(this,n)}};var n=$.chain,e=function(t,i){var s=null;return function(){var n=arguments;clearTimeout(s),s=setTimeout(function(){t.apply(this,n)}.bind(this),i||0)}};$.fn.videos=function(t){var i=this.find("video");switch(i=i.add(this.filter("video")),t){case"destroy":return i.each(function(t,i){i[a.i]&&(i[a.i].destroy(),delete i[a.i])}),i}return i.each(function(i,s){s[a.i]||new a($(s),t)}),i},i($.fn.videos,{isTouch:!1});var r=function(){window.removeEventListener("touchstart",r),$.fn.videos.isTouch=!0};window.addEventListener("touchstart",r);var a=$.Video=function t(i,s){this.id=++t.s,this.el=i[0],this.$el=i,this.el[t.i]=this,this.options=this.n={},this.defaults(),this.setOptions(s),this.initialize()};i(a,{s:0,e:0,r:{},i:"player",a:["load","waiting","preplay","play","pause","timeupdate","finish"],removeEventsHandler:function(){var t=a.r;if(a.e)for(var i in t){var s=t[i],n=s.$el;s.forEach(function(t){a.a.forEach(function(t){n.off(t,a.o)})}),delete t[i],a.e--}},o:function(t,s){i(t,s);var n=a.r,e=t.currentTarget,r=t.currentTarget[a.i].id;if(r){var o=n[r];if(o&&o.length){var h=e[a.i];o.forEach(function(i){i.callback.call(h,t,i.n)})}}}}),i(a[s],{defaults:function(){},setOptions:function(t){i(this.n,t)},initialize:function(){},destroy:function(){delete this.el[a.i],this.id=null,this.el=null,this.$el=null},addEventsHandler:function(t,i){var s=a.r;if(t){var n=this.el;this.n.eventsHandler||(this.n.eventsHandler=!0,s[n[a.i].id]=[],s[n[a.i].id].$el=this.$el,a.a.forEach(function(t){this.$el.on(t,a.o)}.bind(this)),a.e++);for(var e=s[n[a.i].id],r=0,o=e.length;r<o;r++){var h=e[r];if(h.callback===t&&h.context===this)return}e.push({context:this,callback:t,options:i})}},removeEventsHandler:function(t){var i=this.el,s=a.r;if(this.n.eventsHandler&&a.e){var n=s[i[a.i].id];if(n&&n.length)if(t)for(var e=n.length-1;e>-1;e--){var r=n[e];if(r.context===this&&r.callback===t){n.splice(e,1),n.length||(a.a.forEach(function(t){this.$el.off(t,a.o)}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,a.e--);break}}else n.forEach(function(t){a.a.forEach(function(t){this.$el.off(t,a.o)}.bind(this))}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,a.e--}},destroy:function(t){this.removeEventsHandler()}}),i($.fn,{play:function(){return this.videos().each(function(t,i){i[a.i].play()}),this},pause:function(){return this.videos().each(function(t,i){i[a.i].pause()}),this},mute:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){if(t||i&&!n.muted)return n.muted=!0,void(n.volume=0);n.muted=!1,n.volume=1}),this},loop:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){t||i&&!n.loop?n.loop=!0:n.loop=!1}),this}}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({muted:Boolean(this.$el.attr("muted"))||!1,loop:Boolean(this.$el.attr("loop"))||!1,controls:!0}),t()}),initialize:n(a[s].initialize,function(t){this.$el.mute(this.n.muted),this.$el.loop(this.n.loop),this.handleInputEvent=this.handleInputEvent.bind(this),this.h=this.h.bind(this),this.c=e(this.c,3e3),this.n.controls&&this.controls("start"),t()}),controls:function(t,i){switch(t){case"start":this.l(i);break;case"stop":this.u(i)}return this},play:function(){if(this.$el[0].play){this.$el.trigger("preplay");try{this.$el[0].play()}catch(t){}}},pause:function(){this.$el[0].play&&this.$el[0].pause()},l:function(t){this.f=$("[for='"+this.$el.attr("id")+"'][kind=controls]"),this.f.on("click",this.handleInputEvent),this.f.on("mousemove",this.handleInputEvent),t=i({},this.n,t,{controls:!0}),this.addEventsHandler(this.d,t),this.p(),this.f.removeClass("playing paused"),this.f.addClass("paused")},handleInputEvent:function(t){var i=$(t.target);if($.fn.videos.isTouch)switch(t.type){case"click":if(!this.el.paused&&$.fn.videos.isTouch&&!this.g&&this.f.find(".scrub").length>0)return this.g=!0,this.f.addClass("mousemove"),void this.c();(i.is(".play, .toggle")||0!==i.parents(".play, .toggle").length)&&this.h(),this.c();break;case"mousemove":this.c()}else switch(t.type){case"click":(i.is(".play, .toggle")||0!==i.parents(".play, .toggle").length)&&this.h();break;case"mousemove":this.g=!0,this.f.addClass("mousemove"),this.c()}},g:!1,c:function(){this.g=!1,this.f&&this.f.removeClass("mousemove")},h:function(){this.$el[0].paused?this.play():this.pause()},d:function(t,i){switch(t.type){case"play":this.f.removeClass("playing paused"),this.f.addClass("playing");break;case"pause":case"finish":this.f.removeClass("playing paused"),this.f.addClass("paused")}this.p()},p:function(){var t=this.el.currentTime<=1,i=this.el.currentTime>=this.el.duration-1;this.f[t?"addClass":"removeClass"]("at-start"),this.f[i?"addClass":"removeClass"]("at-end"),this.f[t||i?"removeClass":"addClass"]("in-middle")},u:function(t){this.f&&(this.f.off("click",this.handleInputEvent),this.f.off("mousemove",this.handleInputEvent),this.f=null,this.removeEventsHandler(this.d,t))},destroy:n(a[s].destroy,function(t){this.u(),t()})}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({buffering:!0}),t()}),initialize:n(a[s].initialize,function(t){this.n.buffering&&this.buffering("start"),t()}),buffering:function(t,i){switch(t){case"start":this.v(i);break;case"stop":this.m(i)}return this},v:function(t){this.b=$("[for='"+this.$el.attr("id")+"'][kind=buffering]"),this.b.on("click",this.handleInputEvent),t=i({},this.n,t,{buffering:!0}),this.addEventsHandler(this.k,t)},k:function(t,i){switch(t.type){case"preload":this.n._=this.el.currentTime;case"timeupdate":case"waiting":case"load":if(this.n._===this.el.currentTime)if(this.n.y){if(Date.now()-this.n.y>1)return void this.b.addClass("buffering")}else this.n.y=Date.now();else this.n.y=null;case"play":case"pause":case"finish":this.b.removeClass("buffering"),this.n._=this.el.currentTime}},m:function(t){this.w&&(this.b.off("click",this.handleInputEvent),this.b=null,this.removeEventsHandler(this.d,t))},destroy:n(a[s].destroy,function(t){this.m(),t()})}),i(t,{$:0}),i(t[s],{x:null,z:null,T:!1,E:!1,t:function(t){$.ajax({url:this.src,dataType:"text",success:function(i){this.S(i),this.M=!1,this.T=!0,t&&t(this)}.bind(this),error:function(i){this.M=i,this.T=!0,t&&t(this)}.bind(this)})},isReady:function(){return this.T&&!this.M},S:function(s){var n=s.indexOf("\r\n")>-1?"\r\n":"\n",e=s.split(n);this.x=[],this.z=[];for(var r=[],a=0,o=e.length;a<o;a++){var h=e[a],c=a===e.length-1,l=!h;if(c&&!l&&r.push(h),(c||l)&&r.length){if(r[0].toLowerCase().indexOf("webvtt")>-1&&(r.splice(0,1),!r.length))continue;this.x.push({id:++t.$,title:"",start:null,end:null,placement:null,lines:r}),r=[]}else l||r.push(h)}this.x=this.x.filter(function(t){if(0!==t.lines[0].indexOf("NOTE")){if(0===t.lines[0].indexOf("STYLE"))return t.lines.splice(0,1),void this.z.push(t.lines.join("\n"));if(-1===t.lines[0].indexOf("--\x3e")&&(t.title=t.lines[0],t.lines.shift()),-1===t.lines[0].indexOf("--\x3e"))throw"Error";return i(t,this.H(t.lines[0])),t.lines.shift(),!0}}.bind(this))},H:function(t){t=t.trim();var i=$.indexOfRegex(t,/-->/);if(-1===i)throw"Time declaration error, no --\x3e";var s=t.slice(0,i).trim();t=t.slice(i);var n=$.indexOfRegex(t,/[0-9]+/);if(-1===n)throw"Time declaration error, no end time";t=t.slice(n),-1===(i=$.indexOfRegex(t,/[ ]{1}/))&&(i=t.length);var e=t.slice(0,i).trim();return t=t.slice(i),{start:this.R(s),end:this.R(e),placement:this.B(t)}},D:[.001,1,60,360],R:function(t){var i=t.split(/[\:\.\,]{1}/g).reverse();if(i.length<3)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var s=0,n=0,e=i.length;n<e;n++)s+=this.D[n]*parseInt(i[n]);return s},B:function(t){var i={line:-1,position:"50%",size:"100%",align:"middle"};t.split(" ").filter(function(t){return t}).forEach(function(t){var s=t.split(":"),n=s[1].split(","),e=s[0].toLowerCase();switch(e){case"d":e="vertical";break;case"l":e="line";break;case"t":e="position";break;case"s":e="size";break;case"a":e="align";break;case"vertical":case"line":case"position":case"size":case"align":break;default:throw"Bad position declaration, "+e}i[e]=n[0]||i[e]}),i.vertical="vertical"===i.vertical?"rl":"vertical-lr"===i.vertical?"lr":"horizontal";for(var s in i){var n=i[s];switch(s){case"line":n=String(n||-1);break;case"position":n=String(n||"0%");break;case"size":n=String(n||"100%");break;case"align":switch(n=String(n||"middle")){case"start":case"middle":case"end":break;default:throw"Invalid align declaration"}}}return i}}),i(a,{Lang:t}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({captions:!1}),t()}),initialize:n(a[s].initialize,function(t){if(!this.n.captions)return t();this.captions("start",this.n),t()}),captions:function(t,i){switch(t){case"start":this.I(i);break;case"stop":this.L(i)}return this},captionLanguages:null,Y:null,I:function(t){this.n.captions=!0,this.j(this.q.bind(this)),this.A=$("[for='"+this.$el.attr("id")+"'][kind=captions],[for='"+this.$el.attr("id")+"'][kind=subtitles]"),this.A.on("click",this.handleInputEvent),t=i({},this.n,t,{captions:!0}),this.addEventsHandler(this.O,t)},q:function(t){this.captionLanguages=t,this.Y=null;for(var i in t)if(this.captionLanguages[i].default){this.Y=this.captionLanguages[i];break}},O:function(t,i){if(!t.realtime&&this.captionLanguages){var s=this.el.currentTime,n={},e=0;if(this.A.each(function(t,i){var s=$(i),r=s.attr("srclang");this.captionLanguages[r]&&(n[r]||(n[r]=[],e++),n[r].push(s))}.bind(this)),e)for(var r in n){var a=$(n[r]),o=this.captionLanguages[r],h=o.x.filter(function(t){return t.start<=s&&t.end>=s&&!t.live}),c=o.x.filter(function(t){return(t.start>s||t.end<s)&&t.live});if(0===h.length&&0===c.length)return;a.each(function(t,i){var s=$(i);h.forEach(function(t){t.live=!0,s.append($("<span>",this.P({id:t.id,lang:r,class:"cue"},t)).append($("<span>",{class:"cue-text",html:t.lines.join("<br>")})))}.bind(this)),c.forEach(function(t){t.live=!1,s.find("#"+t.id+".cue").remove()}),s.find(".cue:not([lang="+r+"])").remove()}.bind(this))}}},P:function(t,i){var s=t.class.split(" ");s.push(i.placement.vertical);var n="",e=i.placement;switch(e.vertical){case"horizontal":switch(e.align){case"start":s.push("align-left");break;case"middle":s.push("align-center");break;case"end":s.push("align-right")}n+="width:"+e.size+";",n+="left:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="top:"+e.line+"%"):n+="bottom:"+(100-100*Math.abs(e.line))+"%";break;case"rl":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="left:"+e.line+"%"):n+="right:"+(100-100*Math.abs(e.line))+"%";break;case"lr":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";";var r=String(e.line).indexOf("%")>-1;r||e.line>=0?(e.line,n+="right:"+e.line+"%"):n+="left:"+(100-100*Math.abs(e.line))+"%"}return t.class=s.join(" "),t.style=n,t},L:function(t){this.n.captions=!1,this.A.html(""),this.N=null,this.A=null,t=i({},this.n,t,{captions:!1}),this.removeEventsHandler(this.O)},j:function(t){function i(i){i.isReady()?s++:(n--,delete e[i.lang]),s===n&&t&&t(e)}if("function"!=typeof t&&(t=null),this.captionLanguages)return t(this.captionLanguages);var s=0,n=0,e={};return this.$el.find("track[type='text/vtt']").each(function(t,s){var r=$(s),o=r.attr("srclang"),h=r.attr("src");if(o&&h){if(e[o])return;n++,e[o]=new a.Lang({default:void 0!==r.attr("default"),lang:o,src:h,label:r.attr("label")},i)}}).remove(),e},destroy:n(a[s].destroy,function(t){this.A&&(this.A.off("click",this.handleInputEvent),this.L()),t()})}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({poster:this.$el.attr("poster")||!1}),t()}),initialize:n(a[s].initialize,function(t){this.n.poster&&this.poster("start"),t()}),poster:function(t,i){switch(t){case"start":this.U(i);break;case"stop":this.X(i)}return this},U:function(t){this.C=$("[for='"+this.$el.attr("id")+"'][kind=poster]"),this.C.each(function(t,i){$(i).append($("<img>",{class:"jqv-poster-image",src:this.n.poster}))}.bind(this)),t=i({},this.n,t,{poster:!0}),this.addEventsHandler(this.F,t)},F:function(t,i){switch(t.type){case"play":this.C.removeClass("playing paused"),this.C.addClass("playing");break;case"pause":case"finish":this.C.removeClass("playing paused"),this.C.addClass("paused")}var s=this.el.currentTime<=1,n=this.el.currentTime>=this.el.duration-1;this.C[s?"addClass":"removeClass"]("at-start"),this.C[n?"addClass":"removeClass"]("at-end"),this.C[s||n?"removeClass":"addClass"]("in-middle")},X:function(t){this.C&&(this.C.find(".jqv-poster-image").remove(),this.C=null,this.removeEventsHandler(this.d,t))},destroy:n(a[s].destroy,function(t){this.X(),t()})});var o=window.requestAnimationFrame;i(a,{G:[],J:0,K:62.5,Q:function(t){t.n.V||(t.n.V=!0,a.G.push(t),o(a.W))},W:function(){if(a.G.length){var t=Date.now();if(t-a.J<a.K)return o(a.W);a.J=t,a.G.forEach(function(t){t.el.paused&&!t.n.Z||t.$el.trigger("timeupdate",{realtime:!0})}),o(a.W)}},tt:function(t){if(t.n.V){t.n.V=!1;for(var i=a.G.length-1;i>-1;i--)if(a.G[i]===t)return void a.G.splice(i,1)}}}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({realtime:!0}),t()}),initialize:n(a[s].initialize,function(t){if(!this.n.realtime)return t();this.realtime("start"),t()}),realtime:function(t){switch(t){case"start":this.it();break;case"stop":this.st()}return this},it:function(){this.addEventsHandler(this.nt),this.el.paused||a.Q(this)},nt:function(t,i){switch(t.type){case"preplay":this.n.Z=!0,a.Q(this);break;case"play":a.Q(this),this.n.Z=!1;break;case"pause":case"finish":a.tt(this),this.n.Z=!1;break;case"timeupdate":this.n.Z=!1,this.el.loop||Math.floor(10*this.el.currentTime)!==Math.floor(10*this.el.duration)||this.el.pause()}},st:function(){this.removeEventsHandler(this.nt),a.tt(this),setTimeout(function(){this.el&&this.el.trigger("timeupdate")}.bind(this),100)},destroy:n(a[s].destroy,function(t){this.st(),t()})}),i(a[s],{defaults:n(a[s].defaults,function(t){this.setOptions({scrub:!0}),t()}),initialize:n(a[s].initialize,function(t){this.et=this.et.bind(this),this.rt=this.rt.bind(this),this.n.scrub&&this.scrub("start"),t()}),scrub:function(t,i){switch(t){case"start":this.at(i);break;case"stop":this.ot(i)}return this},at:function(t){this.ht=$("[for='"+this.$el.attr("id")+"'][kind=controls] .scrub"),this.ht.on("click",this.et),this.ht.find(".rail-inner, .rail-back").on("click",this.rt),t=i({},this.n,t,{scrub:!0}),this.addEventsHandler(this.ct,t)},ct:function(t,i){switch(t.type){case"timeupdate":this.ht.find(".rail-inner").css({width:100/this.el.duration*this.el.currentTime+"%"})}},et:function(t){t.preventDefault(),t.stopPropagation()},rt:function(t){var i=this.ht.find(".rail-back").width();this.el.currentTime=t.offsetX/i*this.el.duration},ot:function(t){this.ht&&(this.ht.off("click",this.et),this.ht.find(".rail-inner, .rail-back").off("click",this.rt),this.ht=null,this.removeEventsHandler(this.ct,t))},destroy:n(a[s].destroy,function(t){this.ot(),t()})});})(jQuery);