(function($){function t(t,n){i(this,t),this.t(n)}$("<style>",{text:"[for][kind=captions]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=captions] .cue{position:absolute;font-size:100%;line-height:120%;}[for][kind=captions] .cue .cue-text{background-color:black;color:white;padding:0.2%;}[for][kind=captions] .cue.horizontal{transform:translateX(-50%);}[for][kind=captions] .cue.lr{transform:translateY(-50%);}[for][kind=captions] .cue.rl{transform:translateY(-50%);}[for][kind=captions] .cue.align-left{text-align:left;}[for][kind=captions] .cue.align-right{text-align:right;}[for][kind=captions] .cue.align-center{text-align:center;}[for][kind=captions] .cue.align-top{text-align:left;}[for][kind=captions] .cue.align-middle{text-align:right;}[for][kind=captions] .cue.align-bottom{text-align:center;}[for][kind=controls]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=controls].playing .big-play{display:none;}[for][kind=poster]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=poster].playing img{display:none;}"}).appendTo("head");var i=$.extend,n="prototype";$.indexOfRegex=function(t,i,n){var s=(n=n||0)?t.substring(n):t,e=s.match(i);return e?s.indexOf(e[0])+n:-1},$.lastIndexOfRegex=function(t,i,n){var s=(n=n||0)?t.substring(0,n):t,e=s.match(i);return e?s.lastIndexOf(e[e.length-1]):-1},$.chain=function(t,i){return function(){var s=Array[n].slice.call(arguments,0);return s.unshift(function(){var i=Array[n].slice.call(arguments,0);return t.apply(this,i)}.bind(this)),i.apply(this,s)}};var s=$.chain;$.fn.videos=function(t){var i=this.find("video");switch(i=i.add(this.filter("video")),t){case"destroy":return i.each(function(t,i){i[e.i]&&(i[e.i].destroy(),delete i[e.i])}),i}return i.each(function(i,n){n[e.i]||new e($(n),t)}),i};var e=$.Video=function t(i,n){this.id=++t.n,this.el=i[0],this.$el=i,this.el[t.i]=this,this.options=this.s={},this.defaults(),this.setOptions(n),this.initialize()};i(e,{n:0,e:0,r:{},i:"player",a:["play","pause","timeupdate","finish"],removeEventsHandler:function(){var t=e.r;if(e.e)for(var i in t){var n=t[i],s=n.$el;n.forEach(function(t){e.a.forEach(function(t){s.off(t,e.o)})}),delete t[i],e.e--}},o:function(t,n){i(t,n);var s=e.r,r=t.currentTarget,a=t.currentTarget[e.i].id;if(a){var o=s[a];if(o&&o.length){var h=r[e.i];o.forEach(function(i){i.callback.call(h,t,i.s)})}}}}),i(e[n],{defaults:function(){},setOptions:function(t){i(this.s,t)},initialize:function(){},destroy:function(){delete this.el[e.i],this.id=null,this.el=null,this.$el=null},addEventsHandler:function(t,i){var n=e.r;if(t){var s=this.el;this.s.eventsHandler||(this.s.eventsHandler=!0,n[s[e.i].id]=[],n[s[e.i].id].$el=this.$el,e.a.forEach(function(t){this.$el.on(t,e.o)}.bind(this)),e.e++);for(var r=n[s[e.i].id],a=0,o=r.length;a<o;a++){var h=r[a];if(h.callback===t&&h.context===this)return}r.push({context:this,callback:t,options:i})}},removeEventsHandler:function(t){var i=this.el,n=e.r;if(this.s.eventsHandler&&e.e){var s=n[i[e.i].id];if(s&&s.length)if(t)for(var r=s.length-1;r>-1;r--){var a=s[r];if(a.context===this&&a.callback===t){s.splice(r,1),s.length||(e.a.forEach(function(t){this.$el.off(t,e.o)}.bind(this)),delete n[this.id],this.s.eventsHandler=!1,e.e--);break}}else s.forEach(function(t){e.a.forEach(function(t){this.$el.off(t,e.o)}.bind(this))}.bind(this)),delete n[this.id],this.s.eventsHandler=!1,e.e--}},destroy:s(e[n].destroy,function(t){this.removeEventsHandler(),t()})}),i(t,{h:0}),i(t[n],{c:null,l:null,u:!1,f:!1,t:function(t){$.ajax({url:this.src,dataType:"text",success:function(i){this.d(i),this.p=!1,this.u=!0,t&&t(this)}.bind(this),error:function(i){this.p=i,this.u=!0,t&&t(this)}.bind(this)})},isReady:function(){return this.u&&!this.p},d:function(n){var s=n.indexOf("\r\n")>-1?"\r\n":"\n",e=n.split(s);this.c=[],this.l=[];for(var r=[],a=0,o=e.length;a<o;a++){var h=e[a],c=a===e.length-1,l=!h;if(c&&!l&&r.push(h),(c||l)&&r.length){if(r[0].toLowerCase().indexOf("webvtt")>-1&&(r.splice(0,1),!r.length))continue;this.c.push({id:++t.h,title:"",start:null,end:null,placement:null,lines:r}),r=[]}else l||r.push(h)}this.c=this.c.filter(function(t){if(0!==t.lines[0].indexOf("NOTE")){if(0===t.lines[0].indexOf("STYLE"))return t.lines.splice(0,1),void this.l.push(t.lines.join("\n"));if(-1===t.lines[0].indexOf("--\x3e")&&(t.title=t.lines[0],t.lines.shift()),-1===t.lines[0].indexOf("--\x3e"))throw"Error";return i(t,this.v(t.lines[0])),t.lines.shift(),!0}}.bind(this))},v:function(t){t=t.trim();var i=$.indexOfRegex(t,/-->/);if(-1===i)throw"Time declaration error, no --\x3e";var n=t.slice(0,i).trim();t=t.slice(i);var s=$.indexOfRegex(t,/[0-9]+/);if(-1===s)throw"Time declaration error, no end time";t=t.slice(s),-1===(i=$.indexOfRegex(t,/[ ]{1}/))&&(i=t.length);var e=t.slice(0,i).trim();return t=t.slice(i),{start:this.g(n),end:this.g(e),placement:this._(t)}},m:[.001,1,60,360],g:function(t){var i=t.split(/[\:\.\,]{1}/g).reverse();if(i.length<3)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var n=0,s=0,e=i.length;s<e;s++)n+=this.m[s]*parseInt(i[s]);return n},_:function(t){var i={line:-1,position:"50%",size:"100%",align:"middle"};t.split(" ").filter(function(t){return t}).forEach(function(t){var n=t.split(":"),s=n[1].split(","),e=n[0].toLowerCase();switch(e){case"d":e="vertical";break;case"l":e="line";break;case"t":e="position";break;case"s":e="size";break;case"a":e="align";break;case"vertical":case"line":case"position":case"size":case"align":break;default:throw"Bad position declaration, "+e}i[e]=s[0]||i[e]}),i.vertical="vertical"===i.vertical?"rl":"vertical-lr"===i.vertical?"lr":"horizontal";for(var n in i){var s=i[n];switch(n){case"line":s=String(s||-1);break;case"position":s=String(s||"0%");break;case"size":s=String(s||"100%");break;case"align":switch(s=String(s||"middle")){case"start":case"middle":case"end":break;default:throw"Invalid align declaration"}}}return i}}),i(e,{Lang:t}),i(e[n],{defaults:s(e[n].defaults,function(t){this.setOptions({captions:!1}),t()}),initialize:s(e[n].initialize,function(t){if(!this.s.captions)return t();this.captions("start",this.s),t()}),captions:function(t,i){switch(t){case"start":this.k(i);break;case"stop":this.b(i)}return this},captionLanguages:null,y:null,k:function(t){this.s.captions=!0,this.w=this.w.bind(this),this.$(this.x.bind(this)),this.z=$("[for='"+this.$el.attr("id")+"'][kind=captions],[for='"+this.$el.attr("id")+"'][kind=subtitles]"),this.z.on("click",this.w),t=i({},this.s,t,{captions:!0}),this.addEventsHandler(this.T,t)},w:function(){this.$el[0].paused?this.$el[0].play&&this.$el[0].play():this.$el[0].pause&&this.$el[0].pause()},x:function(t){this.captionLanguages=t,this.y=null;for(var i in t)if(this.captionLanguages[i].default){this.y=this.captionLanguages[i];break}},T:function(t,i){if(!t.realtime&&this.captionLanguages){var n=this.el.currentTime,s={},e=0;if(this.z.each(function(t,i){var n=$(i),r=n.attr("srclang");this.captionLanguages[r]&&(s[r]||(s[r]=[],e++),s[r].push(n))}.bind(this)),e)for(var r in s){var a=$(s[r]),o=this.captionLanguages[r],h=o.c.filter(function(t){return t.start<=n&&t.end>=n&&!t.live}),c=o.c.filter(function(t){return(t.start>n||t.end<n)&&t.live});if(0===h.length&&0===c.length)return;a.each(function(t,i){var n=$(i);h.forEach(function(t){t.live=!0,n.append($("<span>",this.E({id:t.id,lang:r,class:"cue"},t)).append($("<span>",{class:"cue-text",html:t.lines.join("<br>")})))}.bind(this)),c.forEach(function(t){t.live=!1,n.find("#"+t.id+".cue").remove()}),n.find(".cue:not([lang="+r+"])").remove()}.bind(this))}}},E:function(t,i){var n=t.class.split(" ");n.push(i.placement.vertical);var s="",e=i.placement;switch(e.vertical){case"horizontal":switch(e.align){case"start":n.push("align-left");break;case"middle":n.push("align-center");break;case"end":n.push("align-right")}s+="width:"+e.size+";",s+="left:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,s+="top:"+e.line+"%"):s+="bottom:"+(100-100*Math.abs(e.line))+"%";break;case"rl":switch(e.align){case"start":n.push("align-top");break;case"middle":n.push("align-middle");break;case"end":n.push("align-bottom")}s+="height:"+e.size+";",s+="top:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,s+="left:"+e.line+"%"):s+="right:"+(100-100*Math.abs(e.line))+"%";break;case"lr":switch(e.align){case"start":n.push("align-top");break;case"middle":n.push("align-middle");break;case"end":n.push("align-bottom")}s+="height:"+e.size+";",s+="top:"+e.position+";";var r=String(e.line).indexOf("%")>-1;r||e.line>=0?(e.line,s+="right:"+e.line+"%"):s+="left:"+(100-100*Math.abs(e.line))+"%"}return t.class=n.join(" "),t.style=s,t},b:function(t){this.s.captions=!1,this.z.html(""),this.S=null,this.z=null,t=i({},this.s,t,{captions:!1}),this.removeEventsHandler(this.T)},$:function(t){function i(i){i.isReady()?n++:(s--,delete r[i.lang]),n===s&&t&&t(r)}if("function"!=typeof t&&(t=null),this.captionLanguages)return t(this.captionLanguages);var n=0,s=0,r={};return this.$el.find("track[type='text/vtt']").each(function(t,n){var a=$(n),o=a.attr("srclang"),h=a.attr("src");if(o&&h){if(r[o])return;s++,r[o]=new e.Lang({default:void 0!==a.attr("default"),lang:o,src:h,label:a.attr("label")},i)}}).remove(),r},destroy:s(e[n].destroy,function(t){this.z.off("click",this.w),this.b(),t()})}),i($.fn,{play:function(){return this.videos().each(function(t,i){i.play()}),this},pause:function(){return this.videos().each(function(t,i){i.pause()}),this},mute:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(n,s){if(t||i&&!s.muted)return s.muted=!0,void(s.volume=0);s.muted=!1,s.volume=1}),this},loop:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(n,s){t||i&&!s.loop?s.loop=!0:s.loop=!1}),this}}),i(e[n],{defaults:s(e[n].defaults,function(t){this.setOptions({muted:Boolean(this.$el.attr("muted"))||!1,loop:Boolean(this.$el.attr("loop"))||!1,controls:!0}),t()}),initialize:s(e[n].initialize,function(t){this.$el.mute(this.s.muted),this.$el.loop(this.s.loop),this.H=this.H.bind(this),this.w=this.w.bind(this),this.s.controls&&this.controls("start"),t()}),controls:function(t,i){switch(t){case"start":this.R(i);break;case"stop":this.B(i)}return this},R:function(t){this.L=$("[for='"+this.$el.attr("id")+"'][kind=controls]"),this.L.on("click",this.H),t=i({},this.s,t,{controls:!0}),this.addEventsHandler(this.I,t)},H:function(t){var i=$(t.target);(i.is("[kind=controls]")||i.is(".play")||0!==i.parents(".play").length)&&this.w()},w:function(){this.$el[0].paused?this.$el[0].play&&this.$el[0].play():this.$el[0].pause&&this.$el[0].pause()},I:function(t,i){switch(t.type){case"play":this.L.removeClass("playing paused"),this.L.addClass("playing");break;case"pause":this.L.removeClass("playing paused"),this.L.addClass("paused")}},B:function(t){this.L.off("click",this.H),this.L=null,this.removeEventsHandler(this.I,t)},destroy:s(e[n].destroy,function(t){this.B(),t()})}),i(e[n],{defaults:s(e[n].defaults,function(t){this.setOptions({poster:this.$el.attr("poster")||!1}),t()}),initialize:s(e[n].initialize,function(t){this.s.poster&&this.poster("start"),t()}),poster:function(t,i){switch(t){case"start":this.M(i);break;case"stop":this.Y(i)}return this},M:function(t){this.A=$("[for='"+this.$el.attr("id")+"'][kind=poster]"),this.A.each(function(t,i){$(i).append($("<img>",{src:this.s.poster}))}.bind(this)),t=i({},this.s,t,{poster:!0}),this.addEventsHandler(this.D,t)},D:function(t,i){switch(t.type){case"play":this.A.removeClass("playing paused"),this.A.addClass("playing");break;case"pause":this.A.removeClass("playing paused"),this.A.addClass("paused")}},Y:function(t){this.A=null,this.removeEventsHandler(this.I,t)},destroy:s(e[n].destroy,function(t){this.Y(),t()})});var r=window.requestAnimationFrame;i(e,{O:[],P:0,N:62.5,U:function(t){t.s.realtime||(t.s.realtime=!0,e.O.push(t),r(e.X))},X:function(){if(e.O.length){var t=Date.now();if(t-e.P<e.N)return r(e.X);e.P=t,e.O.forEach(function(t){t.el.paused||t.$el.trigger("timeupdate",{realtime:!0})}),r(e.X)}},j:function(t){if(t.s.realtime){t.s.realtime=!1;for(var i=e.O.length-1;i>-1;i--)if(e.O[i]===t)return void e.O.splice(i,1)}}}),i(e[n],{defaults:s(e[n].defaults,function(t){this.setOptions({realtime:!1}),t()}),initialize:s(e[n].initialize,function(t){if(!this.s.realtime)return t();this.realtime("start"),t()}),realtime:function(t){switch(t){case"start":this.q();break;case"stop":this.C()}return this},q:function(){this.addEventsHandler(this.F),this.el.paused||e.U(this)},F:function(t,i){switch(t.type){case"play":if(this.s.realtime)return;e.U(this);break;case"pause":case"finish":if(!this.s.realtime)return;e.j(this)}},C:function(){this.removeEventsHandler(this.F),e.j(this)},destroy:s(e[n].destroy,function(t){this.C(),t()})});})(jQuery);