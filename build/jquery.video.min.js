(function($){function t(t,s){i(this,t),this.t(s)}$("<style>",{text:"[for][kind=buffering]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=buffering]{display:none;}[for][kind=buffering].buffering{display:block;}[for][kind=captions]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=captions] .cue{position:absolute;font-size:100%;line-height:120%;}[for][kind=captions] .cue .cue-text{background-color:black;color:white;padding:0.2%;}[for][kind=captions] .cue.horizontal{transform:translateX(-50%);}[for][kind=captions] .cue.lr{transform:translateY(-50%);}[for][kind=captions] .cue.rl{transform:translateY(-50%);}[for][kind=captions] .cue.align-left{text-align:left;}[for][kind=captions] .cue.align-right{text-align:right;}[for][kind=captions] .cue.align-center{text-align:center;}[for][kind=captions] .cue.align-top{text-align:left;}[for][kind=captions] .cue.align-middle{text-align:right;}[for][kind=captions] .cue.align-bottom{text-align:center;}[for][kind=controls]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=controls]{opacity:1;transition:opacity 0.2s ease-in;}[for][kind=controls].playing .big-play{opacity:0;}[for][kind=poster]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=poster] img{opacity:1;transition:opacity 0.2s ease-in;}[for][kind=poster].paused.in-middle img,[for][kind=poster].playing img{opacity:0;}[for][kind=controls] .scrub{position:absolute;bottom:0;width:100%;background:rgba(255, 255, 255, 0.82);}[for][kind=controls] .scrub .rail{margin:8px;position:relative;cursor:pointer;}[for][kind=controls] .scrub .rail .rail-back{position:absolute;top:0;left:0;right:0;bottom:0;background-color:lightgrey;}[for][kind=controls] .scrub .rail .rail-inner{position:relative;height:8px;background-color:#d45971;transition:width 0.05s linear;}[for][kind=controls] .scrub{opacity:1;transition:opacity 0.2s ease-in;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}[for][kind=controls].paused.at-start .scrub,[for][kind=controls].paused.at-end .scrub,[for][kind=controls].playing .scrub{opacity:0}[for][kind=controls].mousemove.paused.in-middle .scrub,[for][kind=controls].mousemove.paused.at-end .scrub,[for][kind=controls].mousemove.playing .scrub{opacity:1}"}).appendTo("head");var i=$.extend,s="prototype";$.indexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(s):t,e=n.match(i);return e?n.indexOf(e[0])+s:-1},$.lastIndexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(0,s):t,e=n.match(i);return e?n.lastIndexOf(e[e.length-1]):-1},$.chain=function(t,i){return function(){var n=Array[s].slice.call(arguments,0);return n.unshift(function(){var i=Array[s].slice.call(arguments,0);return t.apply(this,i)}.bind(this)),i.apply(this,n)}};var n=$.chain,e=function(t,i){var s=null;return function(){var n=arguments;clearTimeout(s),s=setTimeout(function(){t.apply(this,n)}.bind(this),i||0)}};$.fn.videos=function(t){var i=this.find("video");switch(i=i.add(this.filter("video")),t){case"destroy":return i.each(function(t,i){i[r.i]instanceof r&&(i[r.i].destroy(),delete i[r.i])}),i}return i.each(function(i,s){s[r.i]||new r($(s),t)}),i},i($.fn.videos,{isTouch:!1});var o=function(){window.removeEventListener("touchstart",o),$.fn.videos.isTouch=!0};window.addEventListener("touchstart",o);var r=$.Video=function t(i,s){this.id=++t.s,this.el=i[0],this.$el=i,this.el[t.i]=this,this.options=this.n={},this.defaults(),this.setOptions(s),this.initialize()};i(r,{s:0,e:0,o:{},i:"player",r:["load","waiting","preplay","play","pause","timeupdate","finish"],removeEventsHandler:function(){var t=r.o;if(r.e)for(var i in t){var s=t[i],n=s.$el;s.forEach(function(t){r.r.forEach(function(t){n.off(t,r.a)})}),delete t[i],r.e--}},a:function(t,s){i(t,s);var n=r.o,e=t.currentTarget,o=t.currentTarget[r.i].id;if(o){var a=n[o];if(a&&a.length){var h=e[r.i];a.forEach(function(i){i.callback.call(h,t,i.n)})}}}}),i(r[s],{defaults:function(){},setOptions:function(t){i(this.n,t)},initialize:function(){},destroy:function(){delete this.el[r.i],this.id=null,this.el=null,this.$el=null},addEventsHandler:function(t,i){var s=r.o;if(t){var n=this.el;this.n.eventsHandler||(this.n.eventsHandler=!0,s[n[r.i].id]=[],s[n[r.i].id].$el=this.$el,r.r.forEach(function(t){this.$el.on(t,r.a)}.bind(this)),r.e++);for(var e=s[n[r.i].id],o=0,a=e.length;o<a;o++){var h=e[o];if(h.callback===t&&h.context===this)return}e.push({context:this,callback:t,options:i})}},removeEventsHandler:function(t){var i=this.el,s=r.o;if(this.n.eventsHandler&&r.e){var n=s[i[r.i].id];if(n&&n.length)if(t)for(var e=n.length-1;e>-1;e--){var o=n[e];if(o.context===this&&o.callback===t){n.splice(e,1),n.length||(r.r.forEach(function(t){this.$el.off(t,r.a)}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,r.e--);break}}else n.forEach(function(t){r.r.forEach(function(t){this.$el.off(t,r.a)}.bind(this))}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,r.e--}},destroy:function(t){this.removeEventsHandler()}}),i($.fn,{play:function(){return this.videos().each(function(t,i){i[r.i].play()}),this},pause:function(){return this.videos().each(function(t,i){i[r.i].pause()}),this},mute:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){if(t||i&&!n.muted)return n.muted=!0,void(n.volume=0);n.muted=!1,n.volume=1}),this},loop:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){t||i&&!n.loop?n.loop=!0:n.loop=!1}),this}}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({muted:Boolean(this.$el.attr("muted"))||!1,loop:Boolean(this.$el.attr("loop"))||!1,controls:!0}),t()}),initialize:n(r[s].initialize,function(t){this.$el.mute(this.n.muted),this.$el.loop(this.n.loop),this.handleInputEvent=this.handleInputEvent.bind(this),this.h=this.h.bind(this),this.c=e(this.c,3e3),this.n.controls&&this.controls("start"),t()}),controls:function(t,i){switch(t){case"start":this.u(i);break;case"stop":this.l(i)}return this},play:function(){if(this.$el[0].play){this.$el.trigger("preplay");try{this.$el[0].play()}catch(t){}}},pause:function(){this.$el[0].play&&this.$el[0].pause()},u:function(t){this.f=$("[for='"+this.$el.attr("id")+"'][kind=controls]"),this.f.on("click",this.handleInputEvent),this.f.on("mousemove",this.handleInputEvent),t=i({},this.n,t,{controls:!0}),this.addEventsHandler(this.d,t),this.p(),this.f.removeClass("playing paused"),this.f.addClass("paused")},handleInputEvent:function(t){var i=$(t.target);if(!i.is(".play, .toggle")&&(i.is(".no-control")||0!==i.parents(".no-control").length))return this.f.addClass("mousemove"),void this.c();if($.fn.videos.isTouch)switch(t.type){case"click":if(!this.el.paused&&$.fn.videos.isTouch&&!this.m&&this.f.find(".scrub").length>0)return this.m=!0,this.f.addClass("mousemove"),void this.c();(i.is(".play, .toggle")||0!==i.parents(".play, .toggle").length)&&this.h(),this.c();break;case"mousemove":this.c()}else switch(t.type){case"click":(i.is(".play, .toggle")||0!==i.parents(".play, .toggle").length)&&this.h();break;case"mousemove":this.m=!0,this.f.addClass("mousemove"),this.c()}},m:!1,c:function(){this.m=!1,this.f&&this.f.removeClass("mousemove")},h:function(){this.$el[0].paused?this.play():this.pause()},d:function(t,i){switch(t.type){case"play":this.f.removeClass("playing paused"),this.f.addClass("playing");break;case"pause":case"finish":this.f.removeClass("playing paused"),this.f.addClass("paused")}this.p()},p:function(){var t=this.el.currentTime<=.1,i=this.el.currentTime>=this.el.duration-.1,s=t?"at-start":i?"at-end":"in-middle";this.n.g!==s&&(this.f[t?"addClass":"removeClass"]("at-start"),this.f[i?"addClass":"removeClass"]("at-end"),this.f[t||i?"removeClass":"addClass"]("in-middle"),this.n.g=s)},l:function(t){this.f&&(this.f.off("click",this.handleInputEvent),this.f.off("mousemove",this.handleInputEvent),this.f=null,this.removeEventsHandler(this.d,t))},destroy:n(r[s].destroy,function(t){this.l(),t()})}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({buffering:!0}),t()}),initialize:n(r[s].initialize,function(t){this.n.buffering&&this.buffering("start"),t()}),buffering:function(t,i){switch(t){case"start":this.v(i);break;case"stop":this.b(i)}return this},v:function(t){this.k=$("[for='"+this.$el.attr("id")+"'][kind=buffering]"),this.k.length?(this.k.on("click",this.handleInputEvent),this.n._=!0,t=i({},this.n,t,{buffering:!0}),this.addEventsHandler(this.y,t)):this.k=null},y:function(t,i){switch(t.type){case"preload":this.n.w=this.el.currentTime;case"timeupdate":case"waiting":case"load":if(this.el.paused||this.n.w!==this.el.currentTime)this.n.$=null;else if(this.n.$){if(Date.now()-this.n.$>1)return this.n._=!0,void this.k.addClass("buffering")}else this.n.$=Date.now();case"play":case"pause":case"finish":this.n._&&(this.n._=!1,this.k.removeClass("buffering")),this.n.w=this.el.currentTime}},b:function(t){this.x&&(this.k.off("click",this.handleInputEvent),this.k=null,this.removeEventsHandler(this.d,t))},destroy:n(r[s].destroy,function(t){this.b(),t()})}),i(t,{z:0}),i(t[s],{T:null,E:null,M:!1,S:!1,t:function(t){$.ajax({url:this.src,dataType:"text",success:function(i){this.H(i),this.R=!1,this.M=!0,t&&t(this)}.bind(this),error:function(i){this.R=i,this.M=!0,t&&t(this)}.bind(this)})},isReady:function(){return this.M&&!this.R},H:function(s){var n=s.indexOf("\r\n")>-1?"\r\n":"\n",e=s.split(n);this.T=[],this.E=[];for(var o=[],r=0,a=e.length;r<a;r++){var h=e[r],c=r===e.length-1,u=!h;if(c&&!u&&o.push(h),(c||u)&&o.length){if(o[0].toLowerCase().indexOf("webvtt")>-1&&(o.splice(0,1),!o.length))continue;this.T.push({id:++t.z,title:"",start:null,end:null,placement:null,lines:o}),o=[]}else u||o.push(h)}this.T=this.T.filter(function(t){if(0!==t.lines[0].indexOf("NOTE")){if(0===t.lines[0].indexOf("STYLE"))return t.lines.splice(0,1),void this.E.push(t.lines.join("\n"));if(-1===t.lines[0].indexOf("--\x3e")&&(t.title=t.lines[0],t.lines.shift()),-1===t.lines[0].indexOf("--\x3e"))throw"Error";return i(t,this.B(t.lines[0])),t.lines.shift(),!0}}.bind(this))},B:function(t){t=t.trim();var i=$.indexOfRegex(t,/-->/);if(-1===i)throw"Time declaration error, no --\x3e";var s=t.slice(0,i).trim();t=t.slice(i);var n=$.indexOfRegex(t,/[0-9]+/);if(-1===n)throw"Time declaration error, no end time";t=t.slice(n),-1===(i=$.indexOfRegex(t,/[ ]{1}/))&&(i=t.length);var e=t.slice(0,i).trim();return t=t.slice(i),{start:this.D(s),end:this.D(e),placement:this.I(t)}},L:[.001,1,60,360],D:function(t){var i=t.split(/[\:\.\,]{1}/g).reverse();if(i.length<3)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var s=0,n=0,e=i.length;n<e;n++)s+=this.L[n]*parseInt(i[n]);return s},I:function(t){var i={line:-1,position:"50%",size:"100%",align:"middle"};t.split(" ").filter(function(t){return t}).forEach(function(t){var s=t.split(":"),n=s[1].split(","),e=s[0].toLowerCase();switch(e){case"d":e="vertical";break;case"l":e="line";break;case"t":e="position";break;case"s":e="size";break;case"a":e="align";break;case"vertical":case"line":case"position":case"size":case"align":break;default:throw"Bad position declaration, "+e}i[e]=n[0]||i[e]}),i.vertical="vertical"===i.vertical?"rl":"vertical-lr"===i.vertical?"lr":"horizontal";for(var s in i){var n=i[s];switch(s){case"line":n=String(n||-1);break;case"position":n=String(n||"0%");break;case"size":n=String(n||"100%");break;case"align":switch(n=String(n||"middle")){case"start":case"middle":case"end":break;default:throw"Invalid align declaration"}}}return i}}),i(r,{Lang:t}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({captions:!1}),t()}),initialize:n(r[s].initialize,function(t){if(!this.n.captions)return t();this.captions("start",this.n),t()}),captions:function(t,i){switch(t){case"start":this.N(i);break;case"stop":this.Y(i)}return this},captionLanguages:null,j:null,N:function(t){this.n.captions=!0,this.q(this.A.bind(this)),this.O=$("[for='"+this.$el.attr("id")+"'][kind=captions],[for='"+this.$el.attr("id")+"'][kind=subtitles]"),this.O.on("click",this.handleInputEvent),t=i({},this.n,t,{captions:!0}),this.addEventsHandler(this.P,t)},A:function(t){this.captionLanguages=t,this.j=null;for(var i in t)if(this.captionLanguages[i].default){this.j=this.captionLanguages[i];break}},P:function(t,i){if(!t.realtime&&this.captionLanguages){var s=this.el.currentTime,n={},e=0;if(this.O.each(function(t,i){var s=$(i),o=s.attr("srclang");this.captionLanguages[o]&&(n[o]||(n[o]=[],e++),n[o].push(s))}.bind(this)),e)for(var o in n){var r=$(n[o]),a=this.captionLanguages[o],h=a.T.filter(function(t){return t.start<=s&&t.end>=s&&!t.live}),c=a.T.filter(function(t){return(t.start>s||t.end<s)&&t.live});if(0===h.length&&0===c.length)return;r.each(function(t,i){var s=$(i);h.forEach(function(t){t.live=!0,s.append($("<span>",this.U({id:t.id,lang:o,class:"cue"},t)).append($("<span>",{class:"cue-text",html:t.lines.join("<br>")})))}.bind(this)),c.forEach(function(t){t.live=!1,s.find("#"+t.id+".cue").remove()}),s.find(".cue:not([lang="+o+"])").remove()}.bind(this))}}},U:function(t,i){var s=t.class.split(" ");s.push(i.placement.vertical);var n="",e=i.placement;switch(e.vertical){case"horizontal":switch(e.align){case"start":s.push("align-left");break;case"middle":s.push("align-center");break;case"end":s.push("align-right")}n+="width:"+e.size+";",n+="left:"+e.position+";",(o=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="top:"+e.line+"%"):n+="bottom:"+(100-100*Math.abs(e.line))+"%";break;case"rl":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";",(o=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="left:"+e.line+"%"):n+="right:"+(100-100*Math.abs(e.line))+"%";break;case"lr":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";";var o=String(e.line).indexOf("%")>-1;o||e.line>=0?(e.line,n+="right:"+e.line+"%"):n+="left:"+(100-100*Math.abs(e.line))+"%"}return t.class=s.join(" "),t.style=n,t},Y:function(t){this.n.captions=!1,this.O.html(""),this.X=null,this.O=null,t=i({},this.n,t,{captions:!1}),this.removeEventsHandler(this.P)},q:function(t){function i(i){i.isReady()?s++:(n--,delete e[i.lang]),s===n&&t&&t(e)}if("function"!=typeof t&&(t=null),this.captionLanguages)return t(this.captionLanguages);var s=0,n=0,e={};return this.$el.find("track[type='text/vtt']").each(function(t,s){var o=$(s),a=o.attr("srclang"),h=o.attr("src");if(a&&h){if(e[a])return;n++,e[a]=new r.Lang({default:void 0!==o.attr("default"),lang:a,src:h,label:o.attr("label")},i)}}).remove(),e},destroy:n(r[s].destroy,function(t){this.O&&(this.O.off("click",this.handleInputEvent),this.Y()),t()})}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({poster:this.$el.attr("poster")||!1}),t()}),initialize:n(r[s].initialize,function(t){this.n.poster&&this.poster("start"),t()}),poster:function(t,i){switch(t){case"start":this.C(i);break;case"stop":this.F(i)}return this},C:function(t){this.G=$("[for='"+this.$el.attr("id")+"'][kind=poster]"),this.G.each(function(t,i){$(i).append($("<img>",{class:"jqv-poster-image",src:this.n.poster}))}.bind(this)),t=i({},this.n,t,{poster:!0}),this.addEventsHandler(this.J,t)},J:function(t,i){switch(t.type){case"play":this.G.removeClass("playing paused"),this.G.addClass("playing");break;case"pause":case"finish":this.G.removeClass("playing paused"),this.G.addClass("paused")}var s=this.el.currentTime<=.1,n=this.el.currentTime>=this.el.duration-.1,e=s?"at-start":n?"at-end":"in-middle";this.n.K!==e&&(this.G[s?"addClass":"removeClass"]("at-start"),this.G[n?"addClass":"removeClass"]("at-end"),this.G[s||n?"removeClass":"addClass"]("in-middle"),this.n.K=e)},F:function(t){this.G&&(this.G.find(".jqv-poster-image").remove(),this.G=null,this.removeEventsHandler(this.d,t))},destroy:n(r[s].destroy,function(t){this.F(),t()})});var a=function(t,i){return window.requestAnimationFrame(t)};i(r,{Q:[],V:0,W:62.5,Z:function(t){t.n.tt||(t.n.tt=!0,r.Q.push(t),a(r.it))},it:function(){if(r.Q.length){var t=Date.now();if(t-r.V<r.W)return a(r.it,r.W);r.V=t,r.Q.forEach(function(t){t.el.paused&&!t.n.st||t.$el.trigger("timeupdate",{realtime:!0})}),a(r.it)}},nt:function(t){if(t.n.tt){t.n.tt=!1;for(var i=r.Q.length-1;i>-1;i--)if(r.Q[i]===t)return void r.Q.splice(i,1)}}}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({realtime:!0}),t()}),initialize:n(r[s].initialize,function(t){if(!this.n.realtime)return t();this.realtime("start"),t()}),realtime:function(t){switch(t){case"start":this.et();break;case"stop":this.ot()}return this},et:function(){this.addEventsHandler(this.rt),this.el.paused||r.Z(this)},rt:function(t,i){var s=Math.abs(Math.floor(10*this.el.currentTime)-Math.floor(10*this.el.duration))<=1;switch(t.type){case"preplay":this.n.at=!1,!this.el.loop&&s&&(this.el.currentTime=0),this.n.st=!0,r.Z(this);break;case"play":this.n.at=!1,r.Z(this),this.n.st=!1;break;case"finish":this.n.at=!0;case"pause":r.nt(this),this.n.st=!1,this.el.loop||this.n.at||!s||setTimeout(function(){this.$el&&(this.n.at||(this.n.at=!0,this.$el.trigger("finish")))}.bind(this),100);break;case"timeupdate":this.n.at=!1,this.n.st=!1,this.el.loop||this.el.paused||!s||(r.nt(this),this.el.currentTime=this.el.duration,this.el.pause(),setTimeout(function(){this.$el&&(this.n.at||(this.n.at=!0,this.$el.trigger("finish")))}.bind(this),100))}},ot:function(){this.removeEventsHandler(this.rt),r.nt(this),setTimeout(function(){this.el&&this.$el.trigger("timeupdate")}.bind(this),100)},destroy:n(r[s].destroy,function(t){this.ot(),t()})}),i(r[s],{defaults:n(r[s].defaults,function(t){this.setOptions({scrub:!0}),t()}),initialize:n(r[s].initialize,function(t){this.ht=this.ht.bind(this),this.ct=this.ct.bind(this),this.ut=this.ut.bind(this),this.lt=this.lt.bind(this),this.n.scrub&&this.scrub("start"),t()}),scrub:function(t,i){switch(t){case"start":this.ft(i);break;case"stop":this.dt(i)}return this},ft:function(t){this.pt=$("[for='"+this.$el.attr("id")+"'][kind=controls] .scrub"),this.pt.length?(this.pt.on("click",this.ht),this.pt.find(".rail-inner, .rail-back").on("mousedown touchstart",this.ct),this.pt.find(".rail-inner, .rail-back").on("mousemove touchmove",this.ut),$(document).on("mouseup touchend",this.lt),t=i({},this.n,t,{scrub:!0}),this.addEventsHandler(this.mt,t)):this.pt=null},mt:function(t,i){switch(t.type){case"timeupdate":this.pt.find(".rail-inner").css({width:100/this.el.duration*this.el.currentTime+"%"})}},ht:function(t){},ct:function(t){this.n.gt=!this.el.paused,this.$el.pause(),this.n.vt=!0,this.bt(t)},ut:function(t){this.n.vt&&this.bt(t)},lt:function(t){this.n.vt&&(this.bt(t),this.n.gt&&this.$el.play(),this.n.vt=!1)},bt:function(t){if(isNaN(this.el.duration))this.el.load();else{var i,s=this.pt.find(".rail-back").width(),n=this.pt.find(".rail-back")[0].getBoundingClientRect().left;switch(t.type){case"touchstart":case"touchend":case"touchmove":if(!(t&&t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches.length))return;i=t.originalEvent.touches[0].clientX-n;break;default:i=t.clientX-n}try{this.el.currentTime=i/s*this.el.duration}catch(t){this.$el.play(),this.el.currentTime=i/s*this.el.duration,this.$el.pause()}}},dt:function(t){this.pt&&(this.pt.off("click",this.ht),this.pt.find(".rail-inner, .rail-back").off("mousedown touchstart",this.ct),this.pt.find(".rail-inner, .rail-back").off("mousemove touchmove",this.ut),$(document).off("mouseup touchend",this.lt),this.pt=null,this.removeEventsHandler(this.mt,t))},destroy:n(r[s].destroy,function(t){this.dt(),t()})});})(jQuery);