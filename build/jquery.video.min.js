(function($){function t(t,s){i(this,t),this.t(s)}$("<style>",{text:"[for][kind=buffering]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=buffering]{display:none;}[for][kind=buffering].buffering{display:block;}[for][kind=captions]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=captions] .cue{position:absolute;font-size:100%;line-height:120%;}[for][kind=captions] .cue .cue-text{background-color:black;color:white;padding:0.2%;}[for][kind=captions] .cue.horizontal{transform:translateX(-50%);}[for][kind=captions] .cue.lr{transform:translateY(-50%);}[for][kind=captions] .cue.rl{transform:translateY(-50%);}[for][kind=captions] .cue.align-left{text-align:left;}[for][kind=captions] .cue.align-right{text-align:right;}[for][kind=captions] .cue.align-center{text-align:center;}[for][kind=captions] .cue.align-top{text-align:left;}[for][kind=captions] .cue.align-middle{text-align:right;}[for][kind=captions] .cue.align-bottom{text-align:center;}[for][kind=controls]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=controls].playing .big-play{display:none;}[for][kind=poster]{position:absolute;top:0;left:0;bottom:0;right:0;font-size:22px;font-family:sans-serif;line-height:120%;}[for][kind=poster] img{opacity:1;transition:opacity 0.5s ease-in;}[for][kind=poster].paused.in-middle img,[for][kind=poster].playing img{opacity:0}[for][kind=controls] .scrub{position:absolute;bottom:0;width:100%;background:rgba(255, 255, 255, 0.82);}[for][kind=controls] .scrub .rail{margin:8px;position:relative;}[for][kind=controls] .scrub .rail .rail-back{position:absolute;top:0;left:0;right:0;bottom:0;background-color:lightgrey;}[for][kind=controls] .scrub .rail .rail-inner{position:relative;height:8px;background-color:#d45971;}"}).appendTo("head");var i=$.extend,s="prototype";$.indexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(s):t,e=n.match(i);return e?n.indexOf(e[0])+s:-1},$.lastIndexOfRegex=function(t,i,s){var n=(s=s||0)?t.substring(0,s):t,e=n.match(i);return e?n.lastIndexOf(e[e.length-1]):-1},$.chain=function(t,i){return function(){var n=Array[s].slice.call(arguments,0);return n.unshift(function(){var i=Array[s].slice.call(arguments,0);return t.apply(this,i)}.bind(this)),i.apply(this,n)}};var n=$.chain;$.fn.videos=function(t){var i=this.find("video");switch(i=i.add(this.filter("video")),t){case"destroy":return i.each(function(t,i){i[e.i]&&(i[e.i].destroy(),delete i[e.i])}),i}return i.each(function(i,s){s[e.i]||new e($(s),t)}),i};var e=$.Video=function t(i,s){this.id=++t.s,this.el=i[0],this.$el=i,this.el[t.i]=this,this.options=this.n={},this.defaults(),this.setOptions(s),this.initialize()};i(e,{s:0,e:0,r:{},i:"player",a:["load","waiting","preplay","play","pause","timeupdate","finish"],removeEventsHandler:function(){var t=e.r;if(e.e)for(var i in t){var s=t[i],n=s.$el;s.forEach(function(t){e.a.forEach(function(t){n.off(t,e.o)})}),delete t[i],e.e--}},o:function(t,s){i(t,s);var n=e.r,r=t.currentTarget,a=t.currentTarget[e.i].id;if(a){var o=n[a];if(o&&o.length){var h=r[e.i];o.forEach(function(i){i.callback.call(h,t,i.n)})}}}}),i(e[s],{defaults:function(){},setOptions:function(t){i(this.n,t)},initialize:function(){},destroy:function(){delete this.el[e.i],this.id=null,this.el=null,this.$el=null},addEventsHandler:function(t,i){var s=e.r;if(t){var n=this.el;this.n.eventsHandler||(this.n.eventsHandler=!0,s[n[e.i].id]=[],s[n[e.i].id].$el=this.$el,e.a.forEach(function(t){this.$el.on(t,e.o)}.bind(this)),e.e++);for(var r=s[n[e.i].id],a=0,o=r.length;a<o;a++){var h=r[a];if(h.callback===t&&h.context===this)return}r.push({context:this,callback:t,options:i})}},removeEventsHandler:function(t){var i=this.el,s=e.r;if(this.n.eventsHandler&&e.e){var n=s[i[e.i].id];if(n&&n.length)if(t)for(var r=n.length-1;r>-1;r--){var a=n[r];if(a.context===this&&a.callback===t){n.splice(r,1),n.length||(e.a.forEach(function(t){this.$el.off(t,e.o)}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,e.e--);break}}else n.forEach(function(t){e.a.forEach(function(t){this.$el.off(t,e.o)}.bind(this))}.bind(this)),delete s[this.id],this.n.eventsHandler=!1,e.e--}},destroy:function(t){this.removeEventsHandler()}}),i($.fn,{play:function(){return this.videos().each(function(t,i){i[e.i].play()}),this},pause:function(){return this.videos().each(function(t,i){i[e.i].pause()}),this},mute:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){if(t||i&&!n.muted)return n.muted=!0,void(n.volume=0);n.muted=!1,n.volume=1}),this},loop:function(t){var i=void 0===t;return t=Boolean(t),this.videos().each(function(s,n){t||i&&!n.loop?n.loop=!0:n.loop=!1}),this}}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({muted:Boolean(this.$el.attr("muted"))||!1,loop:Boolean(this.$el.attr("loop"))||!1,controls:!0}),t()}),initialize:n(e[s].initialize,function(t){this.$el.mute(this.n.muted),this.$el.loop(this.n.loop),this.handleInputEvent=this.handleInputEvent.bind(this),this.h=this.h.bind(this),this.n.controls&&this.controls("start"),t()}),controls:function(t,i){switch(t){case"start":this.c(i);break;case"stop":this.l(i)}return this},play:function(){if(this.$el[0].play){this.$el.trigger("preplay");try{this.$el[0].play()}catch(t){}}},pause:function(){this.$el[0].play&&this.$el[0].pause()},c:function(t){this.u=$("[for='"+this.$el.attr("id")+"'][kind=controls]"),this.u.on("click",this.handleInputEvent),t=i({},this.n,t,{controls:!0}),this.addEventsHandler(this.f,t)},handleInputEvent:function(t){var i=$(t.target);(i.is(".play, .toggle")||0!==i.parents(".play, .toggle").length)&&this.h()},h:function(){this.$el[0].paused?this.play():this.pause()},f:function(t,i){switch(t.type){case"play":this.u.removeClass("playing paused"),this.u.addClass("playing");break;case"pause":this.u.removeClass("playing paused"),this.u.addClass("paused")}var s=this.el.currentTime<=1,n=this.el.currentTime>=this.el.duration-1;this.u[s?"addClass":"removeClass"]("at-start"),this.u[n?"addClass":"removeClass"]("at-end"),this.u[s||n?"removeClass":"addClass"]("in-middle")},l:function(t){this.u&&(this.u.off("click",this.handleInputEvent),this.u=null,this.removeEventsHandler(this.f,t))},destroy:n(e[s].destroy,function(t){this.l(),t()})}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({buffering:!0}),t()}),initialize:n(e[s].initialize,function(t){this.n.buffering&&this.buffering("start"),t()}),buffering:function(t,i){switch(t){case"start":this.d(i);break;case"stop":this.p(i)}return this},d:function(t){this.g=$("[for='"+this.$el.attr("id")+"'][kind=buffering]"),this.g.on("click",this.handleInputEvent),t=i({},this.n,t,{buffering:!0}),this.addEventsHandler(this.b,t)},b:function(t,i){switch(t.type){case"preload":this.n.v=this.el.currentTime;case"timeupdate":case"waiting":case"load":if(this.n.v===this.el.currentTime)if(this.n.k){if(Date.now()-this.n.k>1)return void this.g.addClass("buffering")}else this.n.k=Date.now();else this.n.k=null;case"play":case"pause":this.g.removeClass("buffering"),this.n.v=this.el.currentTime}},p:function(t){this._&&(this.g.off("click",this.handleInputEvent),this.g=null,this.removeEventsHandler(this.f,t))},destroy:n(e[s].destroy,function(t){this.p(),t()})}),i(t,{m:0}),i(t[s],{y:null,w:null,$:!1,x:!1,t:function(t){$.ajax({url:this.src,dataType:"text",success:function(i){this.z(i),this.T=!1,this.$=!0,t&&t(this)}.bind(this),error:function(i){this.T=i,this.$=!0,t&&t(this)}.bind(this)})},isReady:function(){return this.$&&!this.T},z:function(s){var n=s.indexOf("\r\n")>-1?"\r\n":"\n",e=s.split(n);this.y=[],this.w=[];for(var r=[],a=0,o=e.length;a<o;a++){var h=e[a],c=a===e.length-1,l=!h;if(c&&!l&&r.push(h),(c||l)&&r.length){if(r[0].toLowerCase().indexOf("webvtt")>-1&&(r.splice(0,1),!r.length))continue;this.y.push({id:++t.m,title:"",start:null,end:null,placement:null,lines:r}),r=[]}else l||r.push(h)}this.y=this.y.filter(function(t){if(0!==t.lines[0].indexOf("NOTE")){if(0===t.lines[0].indexOf("STYLE"))return t.lines.splice(0,1),void this.w.push(t.lines.join("\n"));if(-1===t.lines[0].indexOf("--\x3e")&&(t.title=t.lines[0],t.lines.shift()),-1===t.lines[0].indexOf("--\x3e"))throw"Error";return i(t,this.E(t.lines[0])),t.lines.shift(),!0}}.bind(this))},E:function(t){t=t.trim();var i=$.indexOfRegex(t,/-->/);if(-1===i)throw"Time declaration error, no --\x3e";var s=t.slice(0,i).trim();t=t.slice(i);var n=$.indexOfRegex(t,/[0-9]+/);if(-1===n)throw"Time declaration error, no end time";t=t.slice(n),-1===(i=$.indexOfRegex(t,/[ ]{1}/))&&(i=t.length);var e=t.slice(0,i).trim();return t=t.slice(i),{start:this.S(s),end:this.S(e),placement:this.H(t)}},R:[.001,1,60,360],S:function(t){var i=t.split(/[\:\.\,]{1}/g).reverse();if(i.length<3)throw"Time declaration error, mm:ss.ttt or hh:mm:ss.tt";for(var s=0,n=0,e=i.length;n<e;n++)s+=this.R[n]*parseInt(i[n]);return s},H:function(t){var i={line:-1,position:"50%",size:"100%",align:"middle"};t.split(" ").filter(function(t){return t}).forEach(function(t){var s=t.split(":"),n=s[1].split(","),e=s[0].toLowerCase();switch(e){case"d":e="vertical";break;case"l":e="line";break;case"t":e="position";break;case"s":e="size";break;case"a":e="align";break;case"vertical":case"line":case"position":case"size":case"align":break;default:throw"Bad position declaration, "+e}i[e]=n[0]||i[e]}),i.vertical="vertical"===i.vertical?"rl":"vertical-lr"===i.vertical?"lr":"horizontal";for(var s in i){var n=i[s];switch(s){case"line":n=String(n||-1);break;case"position":n=String(n||"0%");break;case"size":n=String(n||"100%");break;case"align":switch(n=String(n||"middle")){case"start":case"middle":case"end":break;default:throw"Invalid align declaration"}}}return i}}),i(e,{Lang:t}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({captions:!1}),t()}),initialize:n(e[s].initialize,function(t){if(!this.n.captions)return t();this.captions("start",this.n),t()}),captions:function(t,i){switch(t){case"start":this.B(i);break;case"stop":this.D(i)}return this},captionLanguages:null,I:null,B:function(t){this.n.captions=!0,this.L(this.M.bind(this)),this.Y=$("[for='"+this.$el.attr("id")+"'][kind=captions],[for='"+this.$el.attr("id")+"'][kind=subtitles]"),this.Y.on("click",this.handleInputEvent),t=i({},this.n,t,{captions:!0}),this.addEventsHandler(this.j,t)},M:function(t){this.captionLanguages=t,this.I=null;for(var i in t)if(this.captionLanguages[i].default){this.I=this.captionLanguages[i];break}},j:function(t,i){if(!t.realtime&&this.captionLanguages){var s=this.el.currentTime,n={},e=0;if(this.Y.each(function(t,i){var s=$(i),r=s.attr("srclang");this.captionLanguages[r]&&(n[r]||(n[r]=[],e++),n[r].push(s))}.bind(this)),e)for(var r in n){var a=$(n[r]),o=this.captionLanguages[r],h=o.y.filter(function(t){return t.start<=s&&t.end>=s&&!t.live}),c=o.y.filter(function(t){return(t.start>s||t.end<s)&&t.live});if(0===h.length&&0===c.length)return;a.each(function(t,i){var s=$(i);h.forEach(function(t){t.live=!0,s.append($("<span>",this.q({id:t.id,lang:r,class:"cue"},t)).append($("<span>",{class:"cue-text",html:t.lines.join("<br>")})))}.bind(this)),c.forEach(function(t){t.live=!1,s.find("#"+t.id+".cue").remove()}),s.find(".cue:not([lang="+r+"])").remove()}.bind(this))}}},q:function(t,i){var s=t.class.split(" ");s.push(i.placement.vertical);var n="",e=i.placement;switch(e.vertical){case"horizontal":switch(e.align){case"start":s.push("align-left");break;case"middle":s.push("align-center");break;case"end":s.push("align-right")}n+="width:"+e.size+";",n+="left:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="top:"+e.line+"%"):n+="bottom:"+(100-100*Math.abs(e.line))+"%";break;case"rl":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";",(r=String(e.line).indexOf("%")>-1)||e.line>=0?(e.line,n+="left:"+e.line+"%"):n+="right:"+(100-100*Math.abs(e.line))+"%";break;case"lr":switch(e.align){case"start":s.push("align-top");break;case"middle":s.push("align-middle");break;case"end":s.push("align-bottom")}n+="height:"+e.size+";",n+="top:"+e.position+";";var r=String(e.line).indexOf("%")>-1;r||e.line>=0?(e.line,n+="right:"+e.line+"%"):n+="left:"+(100-100*Math.abs(e.line))+"%"}return t.class=s.join(" "),t.style=n,t},D:function(t){this.n.captions=!1,this.Y.html(""),this.A=null,this.Y=null,t=i({},this.n,t,{captions:!1}),this.removeEventsHandler(this.j)},L:function(t){function i(i){i.isReady()?s++:(n--,delete r[i.lang]),s===n&&t&&t(r)}if("function"!=typeof t&&(t=null),this.captionLanguages)return t(this.captionLanguages);var s=0,n=0,r={};return this.$el.find("track[type='text/vtt']").each(function(t,s){var a=$(s),o=a.attr("srclang"),h=a.attr("src");if(o&&h){if(r[o])return;n++,r[o]=new e.Lang({default:void 0!==a.attr("default"),lang:o,src:h,label:a.attr("label")},i)}}).remove(),r},destroy:n(e[s].destroy,function(t){this.Y&&(this.Y.off("click",this.handleInputEvent),this.D()),t()})}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({poster:this.$el.attr("poster")||!1}),t()}),initialize:n(e[s].initialize,function(t){this.n.poster&&this.poster("start"),t()}),poster:function(t,i){switch(t){case"start":this.O(i);break;case"stop":this.P(i)}return this},O:function(t){this.N=$("[for='"+this.$el.attr("id")+"'][kind=poster]"),this.N.each(function(t,i){$(i).append($("<img>",{class:"jqv-poster-image",src:this.n.poster}))}.bind(this)),t=i({},this.n,t,{poster:!0}),this.addEventsHandler(this.U,t)},U:function(t,i){switch(t.type){case"play":this.N.removeClass("playing paused"),this.N.addClass("playing");break;case"pause":this.N.removeClass("playing paused"),this.N.addClass("paused")}var s=this.el.currentTime<=1,n=this.el.currentTime>=this.el.duration-1;this.N[s?"addClass":"removeClass"]("at-start"),this.N[n?"addClass":"removeClass"]("at-end"),this.N[s||n?"removeClass":"addClass"]("in-middle")},P:function(t){this.N&&(this.N.find(".jqv-poster-image").remove(),this.N=null,this.removeEventsHandler(this.f,t))},destroy:n(e[s].destroy,function(t){this.P(),t()})});var r=window.requestAnimationFrame;i(e,{X:[],C:0,F:62.5,G:function(t){t.n.J||(t.n.J=!0,e.X.push(t),r(e.K))},K:function(){if(e.X.length){var t=Date.now();if(t-e.C<e.F)return r(e.K);e.C=t,e.X.forEach(function(t){t.el.paused&&!t.n.Q||t.$el.trigger("timeupdate",{realtime:!0})}),r(e.K)}},V:function(t){if(t.n.J){t.n.J=!1;for(var i=e.X.length-1;i>-1;i--)if(e.X[i]===t)return void e.X.splice(i,1)}}}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({realtime:!0}),t()}),initialize:n(e[s].initialize,function(t){if(!this.n.realtime)return t();this.realtime("start"),t()}),realtime:function(t){switch(t){case"start":this.W();break;case"stop":this.Z()}return this},W:function(){this.addEventsHandler(this.tt),this.el.paused||e.G(this)},tt:function(t,i){switch(t.type){case"preplay":this.n.Q=!0,e.G(this);break;case"play":e.G(this),this.n.Q=!1;break;case"pause":case"finish":e.V(this),this.n.Q=!1;break;case"timeupdate":this.n.Q=!1}},Z:function(){this.removeEventsHandler(this.tt),e.V(this)},destroy:n(e[s].destroy,function(t){this.Z(),t()})}),i(e[s],{defaults:n(e[s].defaults,function(t){this.setOptions({scrub:!0}),t()}),initialize:n(e[s].initialize,function(t){this.it=this.it.bind(this),this.st=this.st.bind(this),this.n.scrub&&this.scrub("start"),t()}),scrub:function(t,i){switch(t){case"start":this.nt(i);break;case"stop":this.et(i)}return this},nt:function(t){this.rt=$("[for='"+this.$el.attr("id")+"'][kind=controls] .scrub"),this.rt.on("click",this.it),this.rt.find(".rail-inner, .rail-back").on("click",this.st),t=i({},this.n,t,{scrub:!0}),this.addEventsHandler(this.at,t)},at:function(t,i){switch(t.type){case"timeupdate":this.rt.find(".rail-inner").css({width:100/this.el.duration*this.el.currentTime+"%"})}},it:function(t){t.preventDefault(),t.stopPropagation()},st:function(t){var i=this.rt.find(".rail-back").width();this.el.currentTime=t.offsetX/i*this.el.duration},et:function(t){this.rt&&(this.rt.off("click",this.it),this.rt.find(".rail-inner, .rail-back").off("click",this.st),this.rt=null,this.removeEventsHandler(this.at,t))},destroy:n(e[s].destroy,function(t){this.et(),t()})});})(jQuery);